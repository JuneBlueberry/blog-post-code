<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    {
      // 举个栗子
      let obj = {
        value: 1
      }
      function demo(){
        console.log(this.value)
      }

      demo.call(obj)  // 1
    }
    {
      //1. 基础版本
      Function.prototype.mycall = function(context){
        context.fn = this
        context.fn()
        delete context.fn
      }

      let obj = {
        value: 1
      }
      function demo(){
        console.log(this.value)
      }

      demo.mycall(obj);
    }

    {
      //2. 允许传入参数
      Function.prototype.mycall = function(context){
         
        context.fn = this

        //解析参数
        let args = arguments.slice(1)
        context.fn(...args)
        delete context.fn
      }

      let obj = {
        value: 1
      }
      function demo(s1, s2){
        console.log(this.value)
        console.log(s1, s2)
      }

      demo.mycall(obj, 'hello', 'world');
    }

    {
      //3.this参数可以为null，指向window
      //  函数可以有返回值
      Function.prototype.mycall = function(context){
        let _context = context || window

        _context.fn = this
 
         //解析参数
         let args = arguments.slice(1)
         let result = _context.fn(...args)
         delete _context.fn

         return result
       }
       
       var value = 2    //window.value = 2
       let obj = {
         value: 1
       }
       function demo(s1, s2){
         console.log(this.value)
         return {
           value: this.value
         }
       }
 
       demo.mycall(null)
       let result = demo.mycall(obj);
       console.log(result)
    }

  </script>
</body>
</html>